<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taming CloudWatch Logs Costs for Legacy EC2 Applications - Blog</title>
    <meta name="description" content="Learn how to reduce CloudWatch Logs costs for legacy EC2 applications without modifying any application code. This guide covers intelligent log collection, retention policies, and proactive cost monitoring.">
    <style>
        /* Dark Theme */
        body {
            background-color: black;
            color: #e6edf3;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            line-height: 1.6;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Navigation */
        header nav {
            margin-bottom: 2em;
            padding-bottom: 1em;
            border-bottom: 1px solid #30363d;
        }
        
        header nav a {
            color: #58a6ff;
            text-decoration: none;
            margin-right: 15px;
            font-weight: 500;
        }
        
        header nav a:hover {
            text-decoration: underline;
        }
        
        /* Hero Section */
        .hero {
            position: relative;
            margin: 2em 0 3em 0;
            border-radius: 12px;
            overflow: hidden;
            min-height: 400px;
            display: flex;
            align-items: flex-end;
            background: linear-gradient(135deg, #0d1117 0%, #161b22 100%);
        }
        
        .hero-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0.6;
            z-index: 1;
        }
        
        .hero-content {
            position: relative;
            z-index: 2;
            padding: 3em;
            width: 100%;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
        }
        
        .hero h1 {
            font-size: 3em;
            color: white;
            margin: 0 0 0.5em 0;
            border: none;
            padding: 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .hero .blog-meta {
            color: #c9d1d9;
            font-size: 1.1em;
            margin: 0;
            padding: 0;
            border: none;
        }
        
        .hero .blog-meta time {
            background: rgba(88, 166, 255, 0.2);
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 500;
            display: inline-block;
        }
        
        /* Typography */
        h1, h2, h3, h4 {
            color: #ffffff;
            margin-top: 2em;
            border-bottom: 1px solid #30363d;
            padding-bottom: 0.5em;
        }
        
        h1 {
            font-size: 2.5em;
            color: #58a6ff;
            border-bottom: 2px solid #1f6feb;
        }
        
        h2 {
            font-size: 1.8em;
            color: #79c0ff;
        }
        
        h3 {
            font-size: 1.4em;
            color: #a5d6ff;
        }
        
        /* Links */
        a {
            color: #58a6ff;
            text-decoration: none;
            transition: color 0.2s;
        }
        
        a:hover {
            color: #79c0ff;
            text-decoration: underline;
        }
        
        /* Code Blocks */
        pre, code {
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
            background-color: #161b22;
            border: 1px solid #30363d;
            border-radius: 6px;
        }
        
        pre {
            padding: 16px;
            overflow-x: auto;
            margin: 1.5em 0;
            line-height: 1.45;
        }
        
        code {
            padding: 0.2em 0.4em;
            font-size: 0.9em;
            color: #e6edf3;
        }
        
        pre code {
            padding: 0;
            background: none;
            border: none;
        }
        
        /* Inline code */
        :not(pre) > code {
            color: #ff7b72; /* Red for inline code */
        }
        
        /* Lists */
        ul, ol {
            padding-left: 2em;
            margin: 1em 0;
        }
        
        li {
            margin: 0.5em 0;
        }
        
        li strong {
            color: #ffa657;
        }
        
        /* Images */
        img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            border: 1px solid #30363d;
            margin: 1.5em 0;
            display: block;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .image-caption {
            text-align: center;
            font-style: italic;
            color: #8b949e;
            font-size: 0.9em;
            margin-top: -0.5em;
            margin-bottom: 2em;
        }
        
        /* Blockquotes */
        blockquote {
            border-left: 4px solid #1f6feb;
            margin: 2em 0;
            padding: 1em 1.5em;
            background-color: rgba(31, 111, 235, 0.1);
            color: #a5d6ff;
            border-radius: 0 6px 6px 0;
        }
        
        blockquote p {
            margin: 0;
        }
        
        /* Note boxes */
        .note {
            border-left: 4px solid #58a6ff;
            margin: 1.5em 0;
            padding: 1em 1.5em;
            background-color: rgba(88, 166, 255, 0.1);
            color: #a5d6ff;
        }
        
        .note strong {
            color: #58a6ff;
        }
        
        /* Warning boxes */
        .warning {
            border-left: 4px solid #ffa657;
            margin: 1.5em 0;
            padding: 1em 1.5em;
            background-color: rgba(255, 166, 87, 0.1);
            color: #ffd7a5;
        }
        
        .warning strong {
            color: #ffa657;
        }
        
        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5em 0;
        }
        
        th, td {
            border: 1px solid #30363d;
            padding: 12px;
            text-align: left;
        }
        
        th {
            background-color: #161b22;
            color: #ffffff;
        }
        
        tr:nth-child(even) {
            background-color: rgba(22, 27, 34, 0.5);
        }
        
        /* Table of Contents */
        .toc {
            background-color: #161b22;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 20px;
            margin: 2em 0;
        }
        
        .toc h3 {
            margin-top: 0;
            border: none;
        }
        
        .toc ul {
            columns: 2;
            column-gap: 40px;
        }
        
        .toc li {
            break-inside: avoid;
        }
        
        /* Back button */
        .back-button {
            display: inline-block;
            background-color: #238636;
            color: white;
            padding: 12px 24px;
            border-radius: 6px;
            margin: 2em 0;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        
        .back-button:hover {
            background-color: #2ea043;
            text-decoration: none;
        }
        
        /* Divider */
        .divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, #30363d, transparent);
            margin: 3em 0;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            body {
                padding: 15px;
            }
            
            .hero {
                min-height: 300px;
                margin: 1em 0 2em 0;
            }
            
            .hero-content {
                padding: 2em;
            }
            
            .hero h1 {
                font-size: 2.2em;
            }
            
            .toc ul {
                columns: 1;
            }
            
            h1 {
                font-size: 2em;
            }
            
            h2 {
                font-size: 1.5em;
            }
        }
        
        @media (max-width: 480px) {
            .hero {
                min-height: 250px;
            }
            
            .hero-content {
                padding: 1.5em;
            }
            
            .hero h1 {
                font-size: 1.8em;
            }
        }
    </style>
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
</head>
<body>
    <header>
        <nav>
            <a href="../../index.html">üè† Home</a> | <a href="../../blog.html">üìö All Blogs</a>
        </nav>
    </header>

    <main>
        <article>

            <!-- Hero Section -->
            <div class="hero">
                <!-- Replace this image URL with your actual hero image -->
                <img src="images/hero.jpg" 
                     alt="AWS Cloud Cost Management Dashboard" 
                     class="hero-image">
                <div class="hero-content">
                    <h1>Taming CloudWatch Logs Costs for Legacy EC2 Applications</h1>
                    <div class="blog-meta">
                        <time datetime="2025-11-09">üìÖ Feb 4, 2025</time>
                    </div>
                </div>
            </div>
            
            <div class="toc">
                <h3>üìã Table of Contents</h3>
                <ul>
                    <li><a href="#introduction">Introduction: The Silent Budget Killer</a></li>
                    <li><a href="#chapter1">Chapter 1: Understanding Your Logging Footprint</a></li>
                    <li><a href="#chapter2">Chapter 2: Intelligent Log Collection with CloudWatch Agent</a></li>
                    <li><a href="#chapter3">Chapter 3: Smart Retention Policies & Archiving</a></li>
                    <li><a href="#chapter4">Chapter 4: Proactive Cost Monitoring & Alerting</a></li>
                    <li><a href="#chapter5">Chapter 5: The Results - Before & After</a></li>
                    <li><a href="#conclusion">Conclusion & Decision Framework</a></li>
                    <li><a href="#resources">Resources & Further Reading</a></li>
                </ul>
            </div>

            <div class="divider"></div>
            
            <h2 id="introduction">Introduction: The Silent Budget Killer</h2>
            <p>Last month, an AWS Cost Anomaly Detection alert revealed a significant spike in "miscellaneous" CloudWatch costs. Deeper investigation identified the source: logs from a legacy EC2 application that had not been actively maintained for months. The application continued to function correctly, but highly verbose DEBUG logging was silently driving up observability spend.</p>
            
            <p>Teams responsible for legacy applications running on EC2 ‚Äî especially those that cannot be modified due to compliance, risk, or resource limitations ‚Äî often face a similar challenge: how to control observability and logging costs without changing existing application code.</p>
            
            <img src="images/1.png" alt="CloudWatch Cost Spikes">
            <div class="image-caption">fig: CloudWatch cost spikes from verbose logging in legacy applications</div>
            
            <div class="metrics-box">
                <h3>üöÄ The Challenge</h3>
                <p>Legacy EC2 applications with unmaintained verbose logging were costing:</p>
                <div class="metrics-grid">
                    <div class="metric">
                        <div class="metric-value">$280.98</div>
                        <div class="metric-label">Monthly CloudWatch Cost</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">85 GB</div>
                        <div class="metric-label">Daily Data Ingested</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">0%</div>
                        <div class="metric-label">DEBUG Logs Utilized</div>
                    </div>
                </div>
            </div>
            
            <p>In this guide, I'll explain the process used to reduce CloudWatch Logs costs by <strong>73.06%</strong> without touching a single line of application code.</p>
            
            <h2 id="chapter1">Chapter 1: Understanding Your Current Logging Footprint</h2>
            <p>Before making changes, you need to understand what you're dealing with. Most legacy EC2 applications follow one of these patterns:</p>
            
            <ul>
                <li><strong>Direct log files:</strong> Writing to <code>/var/log/app/*.log</code> or similar</li>
                <li><strong>Syslog:</strong> Using rsyslog or syslog-ng</li>
                <li><strong>Application-specific:</strong> Custom logging to dedicated directories</li>
            </ul>
            
            <h3>Step 1: Find Your Most Expensive Log Groups</h3>
            <p>First, let's see exactly what's costing you money. In the AWS Cost Explorer:</p>
            
            <ol>
                <li>Go to Cost Explorer ‚Üí Filter by Service ‚Üí CloudWatch</li>
                <li>Add a Tag filter if you have cost allocation tags</li>
                <li>Set the granularity to Daily</li>
            </ol>
            
            <img src="images/2.png" alt="Cost Explorer showing CloudWatch as cost culprit">
            <div class="image-caption">fig: Identifying CloudWatch as the cost culprit in Cost Explorer</div>
            
            <p>Better yet, use the AWS CLI to get programmatic insight:</p>
            
            <pre><code class="language-bash"># Get CloudWatch Logs usage for the last 30 days
aws cloudwatch get-metric-statistics \
  --namespace AWS/Logs \
  --metric-name IncomingBytes \
  --start-time $(date -d "30 days ago" +%Y-%m-%dT%H:%M:%S) \
  --end-time $(date +%Y-%m-%dT%H:%M:%S) \
  --period 86400 \
  --statistics Sum \
  --region us-east-1

# List your most active log groups
aws logs describe-log-groups \
  --query 'logGroups[*].[logGroupName,storedBytes]' \
  --output text | sort -k2 -nr | head -10</code></pre>
            
            <h3>Step 2: Map Log Files to CloudWatch Log Groups</h3>
            <p>If you're already using the CloudWatch Agent, identify which log files are being collected:</p>
            
            <pre><code class="language-bash"># Check if CloudWatch Agent is running
sudo systemctl status amazon-cloudwatch-agent

# View the agent configuration
sudo cat /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.json</code></pre>
            
            <img src="images/3.png" alt="Checking if CloudWatch Agent is running">
            <div class="image-caption">fig: Checking CloudWatch Agent status</div>
            
            <img src="images/4.png" alt="Viewing agent configuration">
            <div class="image-caption">fig: Viewing the agent configuration</div>
            
            <p>If you're not using the agent, examine what's being written:</p>
            
            <pre><code class="language-bash"># Find the largest log files (adjust paths as needed)
sudo find /var/log /opt /app -name "*.log" -type f -exec du -h {} + | sort -rh | head -10

# Check what's being written in real-time
sudo tail -f /var/log/app/application.log | head -100</code></pre>
            
            <h2 id="chapter2">Chapter 2: Strategy 1 - Intelligent Log Collection with CloudWatch Agent</h2>
            <p>Most legacy applications write different log levels (DEBUG, INFO, ERROR) to the same file. We can't change the application, but we can change what we collect.</p>
            
            <div class="strategy-box">
                <h3>üéØ The Smart Collection Strategy</h3>
                <p>Instead of collecting everything, we'll:</p>
                <ul>
                    <li>Collect ERROR logs in real-time (for immediate alerting)</li>
                    <li>Sample INFO logs (for context)</li>
                    <li>Ignore DEBUG logs entirely (unless troubleshooting)</li>
                </ul>
            </div>
            
            <p>Here's the complete CloudWatch Agent configuration that made the biggest difference:</p>
            
            <pre><code class="language-json">{
  "logs": {
    "logs_collected": {
      "files": {
        "collect_list": [
          {
            "file_path": "/var/log/app/application.log",
            "log_group_name": "/app/ec2/application-error",
            "log_stream_name": "{instance_id}",
            "filters": [
              {
                "type": "include",
                "expression": "ERROR|FATAL|CRITICAL",
                "case_sensitive": false
              }
            ]
          },
          {
            "file_path": "/var/log/app/application.log",
            "log_group_name": "/app/ec2/application-info-sample",
            "log_stream_name": "{instance_id}",
            "filters": [
              {
                "type": "include",
                "expression": "INFO|WARN",
                "case_sensitive": false
              }
            ],
            "multi_line_start_pattern": "{datetime_format}",
            "sampling": {
              "type": "random",
              "percent": 20
            }
          },
          {
            "file_path": "/var/log/app/access.log",
            "log_group_name": "/app/ec2/access",
            "log_stream_name": "{instance_id}",
            "multi_line_start_pattern": "{datetime_format}"
          }
        ]
      }
    },
    "log_stream_name": "{instance_id}"
  }
}</code></pre>
            
            <h3>Key Configuration Elements Explained:</h3>
            <ul>
                <li><strong>Filters:</strong> Use regex patterns to separate log levels at collection time</li>
                <li><strong>Sampling:</strong> Only 20% of INFO/WARN logs are sent (reduces volume by 80%)</li>
                <li><strong>Multi-line patterns:</strong> Crucial for Java stack traces or formatted logs</li>
                <li><strong>Separate log groups:</strong> Different retention policies per log level</li>
            </ul>
            
            <h3>Deployment Script:</h3>
            <pre><code class="language-bash">#!/bin/bash
# deploy-cloudwatch-agent.sh
# Stop existing agent
sudo systemctl stop amazon-cloudwatch-agent

# Backup existing config
sudo cp /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.json \
     /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.json.bak

# Install or update agent (if not installed)
if ! command -v amazon-cloudwatch-agent-ctl &> /dev/null; then
    wget https://s3.amazonaws.com/amazoncloudwatch-agent/linux/amd64/latest/amazon-cloudwatch-agent.rpm
    sudo rpm -U ./amazon-cloudwatch-agent.rpm
fi

# Place our new configuration
sudo cp cloudwatch-agent-config.json /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.json

# Start the agent
sudo systemctl start amazon-cloudwatch-agent

# Check status
sudo systemctl status amazon-cloudwatch-agent</code></pre>
            
            <h2 id="chapter3">Chapter 3: Strategy 2 - Smart Retention Policies & Archiving</h2>
            <p>Even with intelligent collection, logs accumulate. For compliance, you might need to keep logs for years‚Äîjust not in expensive CloudWatch Logs.</p>
            
            <h3>Retention Policy Matrix:</h3>
            <table>
                <thead>
                    <tr>
                        <th>Log Type</th>
                        <th>CloudWatch Retention</th>
                        <th>Archive Destination</th>
                        <th>Compliance Reason</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ERROR/FATAL</td>
                        <td>90 days</td>
                        <td>S3 + Glacier (7 years)</td>
                        <td>Audit requirements</td>
                    </tr>
                    <tr>
                        <td>INFO/WARN (sampled)</td>
                        <td>30 days</td>
                        <td>S3 (1 year)</td>
                        <td>Debugging history</td>
                    </tr>
                    <tr>
                        <td>Access Logs</td>
                        <td>30 days</td>
                        <td>S3 (3 years)</td>
                        <td>Security audits</td>
                    </tr>
                    <tr>
                        <td>DEBUG</td>
                        <td>0 days (not collected)</td>
                        <td>N/A</td>
                        <td>Cost optimization</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>Implementing Retention Policies:</h3>
            <pre><code class="language-bash">#!/bin/bash
# set-retention-policies.sh
# Set retention on existing log groups
LOG_GROUPS=$(aws logs describe-log-groups --query 'logGroups[*].logGroupName' --output text)

for group in $LOG_GROUPS; do
  if [[ $group == *"error"* ]]; then
    aws logs put-retention-policy --log-group-name "$group" --retention-in-days 90
    echo "Set 90-day retention for: $group"
  elif [[ $group == *"info"* ]]; then
    aws logs put-retention-policy --log-group-name "$group" --retention-in-days 30
    echo "Set 30-day retention for: $group"
  else
    aws logs put-retention-policy --log-group-name "$group" --retention-in-days 30
    echo "Set default 30-day retention for: $group"
  fi
done</code></pre>
            
            <h3>Archiving to S3/Glacier:</h3>
            <p>For logs that need long-term retention, set up automatic archiving:</p>
            
            <pre><code class="language-yaml"># archive-logs.yaml - CloudFormation template snippet
Resources:
  LogArchiveBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub "${AWS::AccountId}-log-archive"
      LifecycleConfiguration:
        Rules:
          - Id: GlacierTransition
            Status: Enabled
            Transitions:
              - TransitionInDays: 90
                StorageClass: GLACIER
            Prefix: "cloudwatch-logs/"</code></pre>
            
            <h2 id="chapter4">Chapter 4: Strategy 3 - Proactive Cost Monitoring & Alerting</h2>
            <p>Don't wait for the monthly bill. Set up proactive monitoring.</p>
            
            <h3>AWS Budgets for CloudWatch Logs:</h3>
            <pre><code class="language-bash"># Create a monthly budget with alerts
aws budgets create-budget \
    --account-id $(aws sts get-caller-identity --query Account --output text) \
    --budget "{
        \"BudgetName\": \"CloudWatch-Logs-Monthly\",
        \"BudgetLimit\": {\"Amount\": \"100\", \"Unit\": \"USD\"},
        \"CostFilters\": {\"Service\": [\"AmazonCloudWatch\"]},
        \"CostTypes\": {\"IncludeSubscription\": true, \"UseBlended\": false},
        \"TimeUnit\": \"MONTHLY\",
        \"BudgetType\": \"COST\"
    }" \
    --notifications-with-subscribers "[
        {
            \"Notification\": {
                \"NotificationType\": \"ACTUAL\",
                \"ComparisonOperator\": \"GREATER_THAN\",
                \"Threshold\": 80,
                \"ThresholdType\": \"PERCENTAGE\"
            },
            \"Subscribers\": [{\"SubscriptionType\": \"EMAIL\", \"Address\": \"alerts@yourcompany.com\"}]
        }
    ]"</code></pre>
            
            <h3>Real-time Alerting with Lambda and Slack:</h3>
            <pre><code class="language-python"># cost_alert_lambda.py
import boto3
import json
import os
from datetime import datetime, timedelta

cloudwatch = boto3.client('cloudwatch')
logs = boto3.client('logs')

def lambda_handler(event, context):
    # Get CloudWatch Logs metric for last 24 hours
    response = cloudwatch.get_metric_statistics(
        Namespace='AWS/Logs',
        MetricName='IncomingBytes',
        StartTime=datetime.utcnow() - timedelta(hours=24),
        EndTime=datetime.utcnow(),
        Period=86400,
        Statistics=['Sum'],
        Unit='Bytes'
    )
    
    bytes_today = response['Datapoints'][0]['Sum'] if response['Datapoints'] else 0
    gb_today = bytes_today / (1024**3)
    
    # Calculate estimated cost (first 10GB free, then $0.50/GB)
    free_tier_gb = 10
    cost_per_gb = 0.50
    
    if gb_today > free_tier_gb:
        estimated_cost = (gb_today - free_tier_gb) * cost_per_gb
    else:
        estimated_cost = 0
    
    # Send to Slack if over threshold
    if estimated_cost > 50:  # $50 daily threshold
        slack_message = {
            "text": f"CloudWatch Logs Cost Alert",
            "blocks": [
                {
                    "type": "section",
                    "text": {
                        "type": "mrkdwn",
                        "text": f"*CloudWatch Logs Cost Alert*\nEstimated daily cost: ${estimated_cost:.2f}\nData ingested: {gb_today:.2f} GB"
                    }
                },
                {
                    "type": "section",
                    "text": {
                        "type": "mrkdwn",
                        "text": f"*Top Log Groups:*\n{get_top_log_groups()}"
                    }
                }
            ]
        }
        # Post to Slack webhook
        # ... (Slack integration code)
    
    return {"statusCode": 200}

def get_top_log_groups():
    response = logs.describe_log_groups(
        limit=5,
        orderBy='LastEventTime',
        descending=True
    )
    
    top_groups = []
    for group in response['logGroups']:
        gb_size = group.get('storedBytes', 0) / (1024**3)
        top_groups.append(f"‚Ä¢ {group['logGroupName']}: {gb_size:.2f} GB")
    
    return "\n".join(top_groups)</code></pre>
            
            <h2 id="chapter5">Chapter 5: The Results - Before & After</h2>
            <p>After implementing these strategies over two weeks, here's what we achieved:</p>
            
            <img src="images/5.png" alt="CloudWatch Cost Reduction">
            <div class="image-caption">fig: CloudWatch Logs cost reduction after implementing strategies</div>
            
            <div class="metrics-box">
                <h3>üìä Results Summary</h3>
                <div class="metrics-grid">
                    <div class="metric" style="background: linear-gradient(135deg, #1f6feb, #58a6ff);">
                        <div class="metric-value">73.06%</div>
                        <div class="metric-label">Cost Reduction</div>
                    </div>
                    <div class="metric" style="background: linear-gradient(135deg, #238636, #2ea043);">
                        <div class="metric-value">$205.29</div>
                        <div class="metric-label">Monthly Savings</div>
                    </div>
                    <div class="metric" style="background: linear-gradient(135deg, #da3633, #f85149);">
                        <div class="metric-value">72.94%</div>
                        <div class="metric-label">Data Reduction</div>
                    </div>
                    <div class="metric" style="background: linear-gradient(135deg, #8957e5, #ab7df8);">
                        <div class="metric-value">30 days</div>
                        <div class="metric-label">Faster Alerts</div>
                    </div>
                </div>
            </div>
            
            <h3>Cost Comparison:</h3>
            <table>
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Before</th>
                        <th>After</th>
                        <th>Reduction</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Monthly CloudWatch Logs Cost</td>
                        <td>$280.98/month</td>
                        <td>$75.69/month</td>
                        <td>73.06%</td>
                    </tr>
                    <tr>
                        <td>Data Ingested Daily</td>
                        <td>85 GB/day</td>
                        <td>23 GB/day</td>
                        <td>73%</td>
                    </tr>
                    <tr>
                        <td>Retention Period</td>
                        <td>Unlimited</td>
                        <td>Tiered (30/90 days)</td>
                        <td>Optimized</td>
                    </tr>
                    <tr>
                        <td>Alert Response Time</td>
                        <td>End of month</td>
                        <td>Real-time</td>
                        <td>30 days faster</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>Architecture Evolution:</h3>
            <p><strong>Before Architecture:</strong></p>
            <pre><code class="language-plaintext">EC2 Application
      ‚Üì
All Logs (DEBUG, INFO, ERROR)
      ‚Üì
CloudWatch Logs (Unlimited Retention)
      ‚Üì
$$$$$ (Growing Monthly Bill)</code></pre>
            
            <p><strong>After Architecture:</strong></p>
            <pre><code class="language-plaintext">EC2 Application
      ‚Üì
CloudWatch Agent (Intelligent Filtering)
      ‚îú‚îÄ ERROR Logs ‚Üí CloudWatch (90d) ‚Üí S3 ‚Üí Glacier (7y)
      ‚îú‚îÄ INFO Logs (20% sample) ‚Üí CloudWatch (30d) ‚Üí S3 (1y)
      ‚îî‚îÄ DEBUG Logs ‚Üí /dev/null
      ‚Üì
Controlled Costs + Compliance</code></pre>
            
            <h2 id="conclusion">Conclusion & Decision Framework</h2>
            <p>Controlling CloudWatch Logs costs for legacy applications isn't about perfection, it's about pragmatic improvements. Here's your decision framework:</p>
            
            <div class="strategy-box">
                <h3>üîç Decision Framework</h3>
                <pre><code class="language-plaintext">START: Analyze CloudWatch Logs costs
  ‚Üì
IF cost > $200/month AND application can't be modified:
  ‚îÇ
  ‚îú‚îÄ‚ñ∂ Implement CloudWatch Agent filtering (Strategy 1)
  ‚îÇ    ‚îî‚îÄ‚ñ∂ Expected reduction: 40-60%
  ‚îÇ
  ‚îú‚îÄ‚ñ∂ Apply retention policies (Strategy 2)
  ‚îÇ    ‚îî‚îÄ‚ñ∂ Expected reduction: Additional 20-30%
  ‚îÇ
  ‚îî‚îÄ‚ñ∂ Set up cost monitoring (Strategy 3)
       ‚îî‚îÄ‚ñ∂ Prevent future surprises
  ‚Üì
ELSE IF cost < $50/month:
  ‚îÇ
  ‚îî‚îÄ‚ñ∂ Monitor only - optimization effort > savings
  ‚Üì
END: Review quarterly</code></pre>
            </div>
            
            <h3>Key Takeaways:</h3>
            <ul>
                <li>You don't need to modify applications to significantly reduce log costs</li>
                <li>Filtering at the agent level is your most powerful tool</li>
                <li>Tiered retention balances cost with compliance needs</li>
                <li>Proactive monitoring prevents budget surprises</li>
                <li>Document everything ‚Äî especially for auditors questioning reduced logging</li>
            </ul>
            
            <h3>Next Steps:</h3>
            <ul>
                <li><strong>This week:</strong> Run the cost analysis commands to identify your top log groups</li>
                <li><strong>Next week:</strong> Implement the CloudWatch Agent configuration for one non-critical application</li>
                <li><strong>Within a month:</strong> Set up budgets and anomaly detection for your entire AWS account</li>
            </ul>
            
            <h2 id="resources">Resources & Further Reading</h2>
            <h3>AWS Documentation:</h3>
            <ul>
                <li><a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Install-CloudWatch-Agent.html" target="_blank">CloudWatch Agent Configuration Reference</a></li>
                <li><a href="https://aws.amazon.com/cloudwatch/pricing/" target="_blank">CloudWatch Logs Pricing</a></li>
                <li><a href="https://docs.aws.amazon.com/cost-management/latest/userguide/cost-anomaly-detection.html" target="_blank">Cost Anomaly Detection</a></li>
            </ul>
            
            <h3>Open Source Tools:</h3>
            <ul>
                <li><a href="https://fluentbit.io/" target="_blank">Fluent Bit</a> - Alternative lightweight log processor</li>
                <li><a href="https://grafana.com/oss/loki/" target="_blank">Grafana Loki</a> - Cost-effective log aggregation</li>
            </ul>
            
            <h3>AWS Well-Architected Guidance:</h3>
            <ul>
                <li><a href="https://docs.aws.amazon.com/wellarchitected/latest/operational-excellence-pillar/logging-and-monitoring.html" target="_blank">Operational Excellence Pillar - Logging and Monitoring</a></li>
            </ul>
        </article>
    </main>

    <footer>
        <a href="../../blog.html" class="back-button">‚Üê Back to blogs</a>
    </footer>

    <!-- Prism.js Syntax Highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
</body>
</html>